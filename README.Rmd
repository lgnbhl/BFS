---
output:
  md_document:
    variant: markdown_github
---

<!-- badges: start -->
[![CRAN status](https://www.r-pkg.org/badges/version/BFS)](https://CRAN.R-project.org/package=BFS)
[![Grand total](http://cranlogs.r-pkg.org/badges/grand-total/BFS)](https://cran.r-project.org/package=BFS)
[![pipeline status](https://gitlab.com/lgnbhl/BFS/badges/master/pipeline.svg)](https://gitlab.com/lgnbhl/BFS/pipelines)
<!-- badges: end -->

## BFS <img src="man/figures/logo.png" align="right" />

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

### Introduction

The `BFS` R package allows the user to search and download public data from the 
[Swiss Federal Statistical Office (BFS)](https://www.bfs.admin.ch/bfs/en/home/statistics/catalogues-databases/data.html){target="_blank"}
in a dynamic and reproducible way.

```{r eval=FALSE}
# install from CRAN
install.packages("BFS")
```

Caching and path gestion will be improved in the next `BFS` package release (for now only available on Github) using the `pins` R package. You can try the `BFS` development version by installing it from Github.

```{r eval=FALSE}
# install from Github
devtools::install_github("lgnbhl/BFS")
```

### Usage Example

To search and download data from the BFS, you first need to retrieve information about the available datasets. The `bfs_get_metadata()` function returns a data frame/tibble containing the titles, publication dates, observation periods, website urls and download urls of all available BFS datasets of a given language: German ("de", by default), French ("fr"), Italian ("it") or English ("en"). Note that Italian and English languages give access to less datasets.

```{r bfs_get_metadata}
library(BFS)

meta_en <- bfs_get_metadata(language = "en")
```

To search for a dataset, you can use the `bfs_search()` function.

```{r bfs_search}
meta_en_uni <- bfs_search("university students", data = meta_en)

print(meta_en_uni)
```

To download a BFS dataset, add the related url link from the `url_px` column of the downloaded metadata as an argument to the `bfs_get_dataset()` function. 

```{r bfs_get_dataset}
df_uni <- bfs_get_dataset(meta_en_uni$url_px[1])

print(df_uni)
```

In case the `url_px` link to download the PC-Axis file is broken, you can have a look at its related BFS webpage using the `url` link. 

```{r browseURL, eval=FALSE}
browseURL(df_uni$url_bfs[1]) # open webpage
```

Sometimes the PC-Axis file of the dataset doesn't exist. You should then use the "STAT-TAB - interactive table" service provided by BFS to download manually the dataset.

To open the folder containing the downloaded BFS dataset (only available in the development version on Github for now), you can simply use the `bfs_open_dir()` function.

```{r, eval = FALSE}
bfs_open_dir()
```

### Other information

Alternative R package: [pxweb](https://github.com/rOpenGov/pxweb){target="_blank"}

This package is in no way officially related to or endorsed by the Swiss Federal Statistical Office (BFS).
